@model IEnumerable<DigitaLibrary.Models.Favorite>
@{
    ViewData["Title"] = "Favorilerim";
}

<style>
    /* Üst blok komple tıklanabilir görünsün */
    .card-top-link {
        display: block;
        text-decoration: none;
        color: inherit;
    }

        .card-top-link .work-cover {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform .3s;
            display: block;
        }

    .work-card:hover .work-cover {
        transform: scale(1.05);
    }

    .work-card .card-title {
        font-size: .95rem;
        font-weight: 600;
        line-height: 1.3;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>

<h2 class="mb-3">Favorilerim</h2>

@if (!Model.Any())
{
    <div class="alert alert-info">Henüz favori eklemediniz.</div>
}
else
{
    <div class="row row-cols-1 row-cols-md-3 g-4">
        @foreach (var f in Model)
        {
            var w = f.Work!;
            <div class="col">
                <div class="card h-100 shadow-sm work-card">
                    <!-- ÜST BLOK: KAPAK + BAŞLIK = LİNK -->
                    <a asp-controller="AcademicWorks" asp-action="Details" asp-route-slug="@w.Slug"
                       class="card-top-link">
                        <img src="@Url.Content(string.IsNullOrWhiteSpace(w.CoverImagePath) ? "~/images/no-cover.png" : w.CoverImagePath)"
                             class="card-img-top work-cover" alt="@w.Title" />
                        <div class="card-body text-center">
                            <h5 class="card-title mb-0">@w.Title</h5>
                        </div>
                    </a>

                    <!-- Alt bilgi (linkin DIŞINDA) -->
                    <div class="card-footer d-flex justify-content-between small text-muted">
                        <span>@w.Category?.Name</span>
                        <span>@w.CreatedAt.ToLocalTime().ToString("dd.MM.yyyy")</span>
                    </div>

                    <!-- Aksiyonlar (linkin DIŞINDA; butonlar tıklanabilir kalır) -->
                    <div class="card-footer d-flex gap-2">
                       @*  <a asp-controller="AcademicWorks" asp-action="Details" asp-route-slug="@w.Slug"
                           class="btn btn-sm btn-outline-primary">Detay</a> *@

                        <form asp-controller="Favorites" asp-action="Toggle" method="post" class="d-inline">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="workId" value="@w.Id" />
                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                <i class="bi bi-heart-fill"></i> Kaldır
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        }
    </div>
}
